# üìò INSTRUCCIONES DETALLADAS ‚Äî SISTEMA DE GESTI√ìN DE BARBER√çA (FULL STACK)

## 1Ô∏è‚É£ OBJETIVO GENERAL
Desarrollar un sistema integral para la gesti√≥n completa de una barber√≠a moderna: registro de citas, control de clientes, gesti√≥n de barberos, emisi√≥n de boletas, configuraci√≥n visual del recibo impreso (impresora t√©rmica), y personalizaci√≥n del negocio (logo, nombre, colores, URL del website, etc.).
El sistema debe ser r√°pido, modular, escalable y f√°cil de mantener.

---

## 2Ô∏è‚É£ OBJETIVOS ESPEC√çFICOS
- Crear una base de datos optimizada con √≠ndices estrat√©gicos.
- Implementar un backend escalable en **Spring Boot** con endpoints inteligentes.
- Desarrollar un frontend en **Angular** con cach√© y renderizado eficiente.
- Permitir la **personalizaci√≥n completa del ticket t√©rmico**.
- Configurar un sistema de autenticaci√≥n seguro (JWT o sesi√≥n).
- Minimizar las peticiones al backend mediante almacenamiento en cach√©.
- Preparar el sistema para un despliegue futuro en **Render** o **AWS**.
- Garantizar bajo consumo de recursos y alta velocidad de respuesta.

---

## 3Ô∏è‚É£ ARQUITECTURA GENERAL
El proyecto seguir√° una arquitectura **monol√≠tica modular** en esta primera fase, con posibilidad de migrar a microservicios m√°s adelante.
La estructura se dividir√° en **capas bien separadas**:

### üß© Backend (Spring Boot)
- **Capa Controller**: manejar las peticiones REST y enviar respuestas optimizadas.
- **Capa Service**: contener toda la l√≥gica de negocio.
- **Model**:
- **Capa Repository (JPA)**: manejar acceso a la base de datos con consultas personalizadas e √≠ndices.
- **Capa DTOs**: para manejar datos combinados y optimizar respuestas al frontend.
- **Configuraci√≥n global**: manejo de cach√©, logging, cors, y manejo de errores centralizado.

### üß† Frontend (Angular)
- **M√≥dulos**: `DashboardModule`, `CitasModule`, `ClientesModule`, `ConfiguracionModule`, `UsuariosModule`, etc.
- **Componentes**: formularios reactivos, listas, modales, vistas de impresi√≥n.
- **Cach√© local**: uso de `BehaviorSubject`, `LocalStorage` y `Service Workers` para minimizar peticiones.
- **Dise√±o responsive y limpio** con Tailwind o Angular Material.
- **Configuraci√≥n visual del ticket** editable desde el panel de configuraci√≥n.

---
========================================================
PROYECTO SAS MULTITENANT PARA BARBER√çAS
========================================================

OBJETIVO DEL PROYECTO:
- Crear un sistema web interactivo para barber√≠as y peluquer√≠as.
- Permitir m√∫ltiples barber√≠as (tenants) usando la misma infraestructura.
- Cada barber√≠a puede tener su propia configuraci√≥n de dashboard, promociones, cat√°logo, cortes y servicios.
- Incluir funcionalidades opcionales como boletas, fidelizaci√≥n, asignaci√≥n de citas, y registro de clientes.
- Integrar IA para reconocimiento facial y personalizaci√≥n del cat√°logo de cortes.
- Escalable y econ√≥mico, con posibilidad de migrar a AWS o servicios m√°s robustos en el futuro.

- Buenas pr√°cticas:
  - Indices en columnas de b√∫squeda frecuente: cliente_id, barberia_id, fecha, estado.
  - Normalizaci√≥n para evitar datos duplicados.
  - Guardar im√°genes **como URLs** en Cloudinary o Firebase Storage, evitando Base64 en la DB.

--------------------------------------------------------
2. BACKEND (Spring Boot)
--------------------------------------------------------
- API RESTful que maneja todas las operaciones CRUD.
- Endpoints principales:
  - /api/barberias ‚Üí informaci√≥n y configuraci√≥n
  - /api/clientes ‚Üí gesti√≥n de clientes
  - /api/cortes ‚Üí cat√°logo de cortes y productos
  - /api/promociones ‚Üí gesti√≥n de promociones
  - /api/boletas ‚Üí generaci√≥n de boletas y detalles
  - /api/citas ‚Üí asignaci√≥n y reserva de citas
  - /api/configuracion-completa ‚Üí devuelve un JSON completo con todas las configuraciones de barber√≠a (cacheable)
  - /api/logs ‚Üí registrar actividad
  - /api/reclamos ‚Üí gestionar libro de reclamos

- Buenas pr√°cticas:
  - Uso de **@Cacheable** en endpoints que devuelven configuraciones para reducir peticiones.
  - Validaciones de datos y control de errores.
  - Seguridad: JWT o session management si es necesario para usuarios administrativos.
  - Integraci√≥n con IA (Python/FastAPI) mediante endpoints separados o microservicio independiente.
  - Manejo de transacciones en operaciones que involucren boletas y puntos de fidelidad.

--------------------------------------------------------
3. FRONTEND (Angular 20)
--------------------------------------------------------
- Dashboard interactivo basado en configuraci√≥n recibida desde backend.
- Componentes del Dashboard que se pueden mostrar u ocultar seg√∫n barber√≠a:
  - Fidelidad de cortes
  - Mejor cliente
  - Promociones activas
  - Gr√°ficos de ventas
- Cat√°logo de cortes y productos renderizado din√°micamente.
- Reservas de citas con selecci√≥n de barbero, fecha y hora.
- Manejo de cache en frontend para evitar m√∫ltiples peticiones (RxJS BehaviorSubject).
- Conexi√≥n con backend y microservicio de IA v√≠a HTTP.

--------------------------------------------------------
4. DESPLIEGUE
--------------------------------------------------------
- Backend y base de datos: **Render** (gratis o plan econ√≥mico), por ahora una instancia compartida para todas las barber√≠as.
- Frontend Angular: desplegado tambi√©n en Render o servicio est√°tico (Netlify/Vercel opcional).
- Almacenamiento de im√°genes: **Cloudinary o Firebase Storage**, guardar solo URLs en DB.
- Dominio:
  - Render puede ofrecer dominio gratuito con subdominio.
  - Para dominio personalizado: comprar en Namecheap, GoDaddy o similar y apuntar al deploy.
- Escalabilidad:
  - Inicial: pocas barber√≠as, costos bajos, DB compartida.
  - Futuro: migrar a AWS o GCP si se requiere m√°s capacidad, separar base de datos por tenant si es necesario.

--------------------------------------------------------
5. BUENAS PR√ÅCTICAS
--------------------------------------------------------
- Usar cache para endpoints pesados (configuraci√≥n, cat√°logos).
- Evitar Base64 en DB, almacenar im√°genes en la nube.
- Indices en columnas de filtrado frecuente.
- Transacciones para operaciones cr√≠ticas (boletas, puntos de fidelidad).
- Microservicios: IA en Python/FastAPI independiente.
- Versionar configuraci√≥n y logs de actividad.
- Backup peri√≥dico de DB y almacenamiento en cloud.
- Peticiones m√≠nimas: cargar configuraci√≥n completa en 1 petici√≥n y usar cache local.

--------------------------------------------------------
6. NOTAS IMPORTANTES
--------------------------------------------------------
- Sistema multitena (multi-tenant) con una sola DB compartida inicialmente.
- Dashboard configurable: cada barber√≠a puede activar/desactivar secciones.
- Cat√°logo din√°mico con secciones, cortes y productos.
- Promociones flexibles: corte gratis, descuento, producto gratis, combinables.
- Boletas con detalle por cliente y puntos de fidelidad.
- Citas con asignaci√≥n de barbero, fecha y hora.
- Logs de actividad y historial de cambios para auditor√≠a.
- URLs de im√°genes y banners almacenados en la nube.
- Reservas, fidelidad, promociones y boletas opcionales seg√∫n barber√≠a.
- Escalable y econ√≥mico, con posibilidad de migraci√≥n a AWS si aumenta la demanda.

========================================================
ENUM UTILIZADOS
========================================================

Enum,Valores
UsuarioTipo,"due√±o, administrativo, barbero, recepcionista, cliente"
Genero,"M, F, O, N"
CatalogoTipo,"corte, producto, servicio"
PromocionTipo,"desc_porcentaje, desc_fijo, gratis, puntos"
AplicableA,"todos, categoria, item"
CitaEstado,"pendiente, confirmada, cancelada, asistida, no_asistio"
MetodoPago,"EFECTIVO, YAPE, PLIN, TARJETA, TRANSFERENCIA"
BoletaEstado,"emitida, anulada"
NivelLog,"INFO, WARN, ERROR"
ReclamoEstado,"pendiente, resuelto, cerrado"